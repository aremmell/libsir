<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libsir: Home</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libsir
   &#160;<span id="projectnumber">2.1.0</span>
   </div>
   <div id="projectbrief">The Standard Incident Reporter logging library</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Home </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#libsir">libsir</a><ul><li class="level2"><a href="#highlights">Highlights</a></li>
<li class="level2"><a href="#platforms">Supported platforms</a></li>
<li class="level2"><a href="#details">Details</a><ul><li class="level3"><a href="#destinations">Destinations</a></li>
<li class="level3"><a href="#decoration">Decoration</a></li>
<li class="level3"><a href="#levels">Levels</a></li>
</ul>
</li>
<li class="level2"><a href="#getstarted">Getting started</a><ul><li class="level3"><a href="#make">make recipies</a><ul><li class="level4"><a href="#testing">For tinkering and testing</a></li>
<li class="level4"><a href="#prod">For production</a></li>
</ul>
</li>
<li class="level3"><a href="#src">Including the source</a></li>
</ul>
</li>
<li class="level2"><a href="#customization">Customization</a><ul><li class="level3"><a href="#config">Strings and Limits</a></li>
<li class="level3"><a href="#defaults">Default options, levels, and text styles</a></li>
<li class="level3"><a href="#preproc">Preprocessor</a></li>
</ul>
</li>
<li class="level2"><a href="#why">Why</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="libsir"></a>
libsir</h1>
<hr/>
<p>libsir is a cross-platform, thread-safe C (C11) logging library that is designed to simplify and streamline the generation of human-readable information in software.</p>
<p>Using libsir, you can make a single call that simultaneously sends information to multiple destinations, <em>each with their own individual preference for format and levels</em>. See Formatting below for more information.</p>
<p>Each 'level' or 'priority' of output can be visually styled however you wish for <code>stdio</code> destinations. This allows for immediate visual confirmation that a message appeared in the terminal that you should pay attention to, while less pressing information is more subtle in appearance.</p>
<h2><a class="anchor" id="highlights"></a>
Highlights</h2>
<hr/>
<p>Why should you use libsir instead of another logging library? I don't know, why should you? <em>Just kidding</em>:</p>
<ul>
<li><em>No dependencies</em> other than <code>pthreads</code>. On Windows, libsir uses the native sychronization API.</li>
<li>Accompanied by a robust <em>test suite</em> to ensure dependable behavior, even if you make modifications to the source.</li>
<li>Won't fail silently&mdash;C library or platform level errors are captured and stored for posterity, on a per-thread basis. The <em>function, file, and line number from which it orginated</em> are also captured. Additionally, libsir defines its own set of error messages to aid in troubleshooting.</li>
<li>Hardened&mdash;every function contains sanity checks for internal state as well as arguments passed in through the external interfaces. libsir's make recipes use &ndash;<em>Wpedantic</em>, too.</li>
<li>Full <b>documentation</b>, thanks to <a href="http://www.stack.nl/~dimitri/doxygen/manual/index.html">Doxygen</a>.</li>
</ul>
<h2><a class="anchor" id="platforms"></a>
Supported platforms</h2>
<p>I've successfully compiled and verified the test suite in these environments:</p>
<table class="doxtable">
<tr>
<th>Toolset </th><th align="center">Version </th><th>OS </th><th align="left">Architecture  </th></tr>
<tr>
<td>gcc </td><td align="center">5.4.0 </td><td>Ubuntu 16.04 </td><td align="left">x64 </td></tr>
<tr>
<td>gcc </td><td align="center">7.3.0 (MinGW) </td><td>Windows 10 </td><td align="left">x64 </td></tr>
<tr>
<td>clang </td><td align="center">9.1.0 </td><td>macOS 10.13.4 </td><td align="left">x64 </td></tr>
</table>
<h2><a class="anchor" id="details"></a>
Details</h2>
<hr/>
<h3><a class="anchor" id="destinations"></a>
Destinations</h3>
<p>Currently, the following destinations are supported:</p>
<ul>
<li><code>stdout</code> and <code>stderr</code></li>
<li><code>syslog</code></li>
<li><em>n</em> number of log files (<em>archived automatically</em>)</li>
</ul>
<h3><a class="anchor" id="decoration"></a>
Decoration</h3>
<p>libsir computes certain data that may be useful in output (<em>particularly for debugging postmortem</em>). Each destination may be configured to receive any, all, or none of these.</p>
<p><em>Note: the appearance of this data may be customized for your application. See <a class="el" href="index.html#customization">Customization</a> for more information.</em></p>
<table class="doxtable">
<tr>
<th>Data </th><th>Description </th><th align="center">stdio </th><th align="center">syslog<sup>†</sup> </th><th align="center">files  </th></tr>
<tr>
<td>Timestamp </td><td>The current time (<em>hour, min, sec</em>) </td><td align="center">x </td><td align="center"></td><td align="center">x </td></tr>
<tr>
<td>Milliseconds </td><td>1/1000<sup>ths</sup> of the current second </td><td align="center">x </td><td align="center"></td><td align="center">x </td></tr>
<tr>
<td>Level </td><td>Human-readable level </td><td align="center">x </td><td align="center"></td><td align="center">x </td></tr>
<tr>
<td>Name </td><td>The name of the process </td><td align="center">x </td><td align="center">x </td><td align="center">x </td></tr>
<tr>
<td>Process ID </td><td>The current process identifier </td><td align="center">x </td><td align="center">x </td><td align="center">x </td></tr>
<tr>
<td>Thread ID </td><td>The current thread identifier </td><td align="center">x </td><td align="center"></td><td align="center">x </td></tr>
</table>
<p><sup>†</sup> <code>syslog</code> <em>already includes many of these categories of data on its own.</em></p>
<h3><a class="anchor" id="levels"></a>
Levels</h3>
<p>In addition to decoration options, each destination may be registered to receive any, none, or all priority levels of output. The available levels may be overly granular, but it's better to have unused levels rather than need another one and not have it.</p>
<table class="doxtable">
<tr>
<th>Level </th><th>Description  </th></tr>
<tr>
<td>Debug </td><td>Debugging/diagnostic output. </td></tr>
<tr>
<td>Information </td><td>Informational messages. </td></tr>
<tr>
<td>Notice </td><td>Normal but significant. </td></tr>
<tr>
<td>Warning </td><td>Warnings that could likely be ignored. </td></tr>
<tr>
<td>Error </td><td>Errors. </td></tr>
<tr>
<td>Critical </td><td>Critical errors. </td></tr>
<tr>
<td>Alert </td><td>Action required ASAP. </td></tr>
<tr>
<td>Emergency </td><td>Nuclear war, Armageddon, the sky is falling. </td></tr>
</table>
<h2><a class="anchor" id="getstarted"></a>
Getting started</h2>
<hr/>
<p>Clone or download this repository to your machine, then choose how you'd like to integrate libsir into your project.</p>
<h3><a class="anchor" id="make"></a>
make recipies</h3>
<p>The following recipies are already prepared for you:</p>
<h4><a class="anchor" id="testing"></a>
For tinkering and testing</h4>
<table class="doxtable">
<tr>
<th>Recipe </th><th>Command </th><th>Output file  </th></tr>
<tr>
<td>Test suite </td><td><code>make tests</code> </td><td><em>build/sirtests[.exe]</em> </td></tr>
<tr>
<td>Example use </td><td><code>make example</code> </td><td><em>build/sirexample[.exe]</em> </td></tr>
</table>
<h4><a class="anchor" id="prod"></a>
For production</h4>
<table class="doxtable">
<tr>
<th>Recipe </th><th>Command </th><th>Output file  </th></tr>
<tr>
<td>Static library </td><td><code>make static</code> </td><td><em>build/lib/libsir_s.a</em> </td></tr>
<tr>
<td>Shared library </td><td><code>make shared</code> </td><td><em>build/lib/libsir.so</em> </td></tr>
<tr>
<td>Install </td><td><code>make install</code> </td><td>/usr/local/lib/libsir.so, /usr/local/include/&lt;headers&gt; </td></tr>
</table>
<p><em>If you'd like to debug libsir, just swap out the commented debug flags in <a href="../Makefile">the makefile</a>.</em></p>
<h3><a class="anchor" id="src"></a>
Including the source</h3>
<p>Simply modify your Makefile (or project file of whatever type) to include all of the source files in the root directory of this repository, and include <a class="el" href="d4/df5/sir_8h.html">sir.h</a>.</p>
<h2><a class="anchor" id="customization"></a>
Customization</h2>
<hr/>
<h3><a class="anchor" id="config"></a>
Strings and Limits</h3>
<p>The following can be modified to alter behavior, and are located in <a class="el" href="d4/d0f/sirconfig_8h.html">sirconfig.h</a>. This is not an exhaustive list, and you should read the header for more information:</p>
<table class="doxtable">
<tr>
<th>Entry </th><th>Description </th><th align="center">Default  </th></tr>
<tr>
<td><code>SIR_TIMEFORMAT</code> </td><td>The time stamp format string at the beginning of log messages. </td><td align="center"><code>"%H:%M:%S"</code> </td></tr>
<tr>
<td><code>SIR_MSECFORMAT</code> </td><td>The format for the current millisecond in time stamps. </td><td align="center"><code>".%03ld"</code> </td></tr>
<tr>
<td><code>SIR_LEVELFORMAT</code> </td><td>The format for the human-readable logging level. </td><td align="center"><code>"[%s]"</code> </td></tr>
<tr>
<td><code>SIR_PIDFORMAT</code> </td><td>The format for the current process/thread ID. </td><td align="center"><code>"%d"</code> </td></tr>
<tr>
<td><code>SIR_FOPENMODE</code> </td><td>The string passed to fopen/fopen_s for log files. </td><td align="center"><code>"a"</code> </td></tr>
<tr>
<td><code>SIR_FROLLSIZE</code> </td><td>The size, in bytes, at which a log file will be rolled/archived. </td><td align="center"><code>(1024L * 1024L * 5L)</code> </td></tr>
<tr>
<td><code>SIR_FHTIMEFORMAT</code> </td><td>The time format string in file headers. </td><td align="center"><code>"%H:%M:%S %a %d %b %y (%z)"</code> </td></tr>
<tr>
<td><code>SIR_FHFORMAT</code> </td><td>The format string written to a log file when logging begins or the file is rolled/archived. </td><td align="center"><code>"\n\n----- %s %s -----\n\n"</code> </td></tr>
<tr>
<td><code>SIR_FHBEGIN</code> </td><td>The string included in <code>SIR_FHFORMAT</code> when a file is rolled/archived due to size. </td><td align="center"><code>"session begin @"</code> </td></tr>
<tr>
<td><code>SIR_FHROLLED</code> </td><td>The string included in <code>SIR_FHFORMAT</code> when a file is rolled/archived due to size. </td><td align="center"><code>"archived as %s due to size @"</code> </td></tr>
<tr>
<td><code>SIR_FNAMEFORMAT</code> </td><td>The format string for rolled/archived log file names. </td><td align="center"><code>"%s-%s%s"</code> </td></tr>
<tr>
<td><code>SIRL_S_EMERG</code> </td><td>The human-readable form of the <code>SIRL_EMERG</code> level. </td><td align="center"><code>"emrg"</code> </td></tr>
<tr>
<td><code>SIRL_S_ALERT</code> </td><td>The human-readable form of the <code>SIRL_ALERT</code> level. </td><td align="center"><code>"alrt"</code> </td></tr>
<tr>
<td><code>SIRL_S_CRIT</code> </td><td>The human-readable form of the <code>SIRL_CRIT</code> level. </td><td align="center"><code>"crit"</code> </td></tr>
<tr>
<td><code>SIRL_S_ERROR</code> </td><td>The human-readable form of the <code>SIRL_ERROR</code> level. </td><td align="center"><code>"erro"</code> </td></tr>
<tr>
<td><code>SIRL_S_WARN</code> </td><td>The human-readable form of the <code>SIRL_WARN</code> level. </td><td align="center"><code>"warn"</code> </td></tr>
<tr>
<td><code>SIRL_S_NOTICE</code> </td><td>The human-readable form of the <code>SIRL_NOTICE</code> level. </td><td align="center"><code>"noti"</code> </td></tr>
<tr>
<td><code>SIRL_S_INFO</code> </td><td>The human-readable form of the <code>SIRL_INFO</code> level. </td><td align="center"><code>"info"</code> </td></tr>
<tr>
<td><code>SIRL_S_DEBUG</code> </td><td>The human-readable form of the <code>SIRL_DEBUG</code> level. </td><td align="center"><code>"debg"</code> </td></tr>
<tr>
<td><code>SIR_MAXFILES</code> </td><td>The maximum number of log files that may be registered. </td><td align="center"><code>16</code> </td></tr>
<tr>
<td><code>SIR_MAXMESSAGE</code> </td><td>The maximum number of characters that may be included in one message, not including other parts of the output, like the timestamp and level. </td><td align="center"><code>2048</code> </td></tr>
</table>
<h3><a class="anchor" id="defaults"></a>
Default options, levels, and text styles</h3>
<p>The following are the defaults used when <code>SIRL_DEFAULT</code> (<a class="el" href="d8/d64/group__public.html#ga4a3303c67acd49bea38fd3565d458cb2">sir_level</a>) or <code>SIRO_DEFAULT</code> (<a class="el" href="d8/d64/group__public.html#ga9ed1c599dfd76231f4e0dadf46bff40b">sir_option</a>) are used. These are located in <a class="el" href="d0/dd1/sirdefaults_8h.html">sirdefaults.h</a>:</p>
<table class="doxtable">
<tr>
<th>Destination </th><th align="center">Levels </th><th>Options  </th></tr>
<tr>
<td><code>stdout</code> </td><td align="center"><code>SIRL_DEBUG | SIRL_INFO | SIRL_NOTICE | SIRL_WARN</code> </td><td><code>SIRO_NOTIME | SIRO_NOPID | SIRO_NOTID</code> </td></tr>
<tr>
<td><code>stderr</code> </td><td align="center"><code>SIRL_ERROR | SIRL_CRIT | SIRL_EMERG</code> </td><td><code>SIRO_NOTIME | SIRO_NOPID | SIRO_NOTID</code> </td></tr>
<tr>
<td><code>syslog</code> </td><td align="center"><code>SIRL_WARN | SIRL_CRIT | SIRL_ALERT | SIRL_EMERG</code> </td><td><code>N/A (_syslog has its own decoration_)</code> </td></tr>
<tr>
<td><code>log files</code> </td><td align="center"><code>SIRL_ALL</code> </td><td><code>0 (_all output_)</code> </td></tr>
</table>
<p>These define the default text styling to use for <code>stdio</code> (<a class="el" href="d8/d64/group__public.html#ga3bd5959a607e5280a8db90ada2d80caf">sir_textstyle</a>) on a per-level basis (<em>can be changed at runtime with</em> sir_set_textstyle) and are also located in <a class="el" href="d0/dd1/sirdefaults_8h.html">sirdefaults.h</a>:</p>
<table class="doxtable">
<tr>
<th>Level </th><th align="center">Style </th><th>Sample  </th></tr>
<tr>
<td><code>SIRL_DEBUG</code> </td><td align="center"><code>SIRS_FG_DGRAY</code> </td><td><div class="image">
<img src="http://gbtw.us/pub/img/debug.png" alt="debug"/>
</div>
 </td></tr>
<tr>
<td><code>SIRL_INFO</code> </td><td align="center"><code>SIRS_FG_WHITE</code> </td><td><div class="image">
<img src="http://gbtw.us/pub/img/info.png" alt="info"/>
</div>
 </td></tr>
<tr>
<td><code>SIRL_NOTICE</code> </td><td align="center"><code>SIRS_FG_CYAN</code> </td><td><div class="image">
<img src="http://gbtw.us/pub/img/notice.png" alt="notice"/>
</div>
 </td></tr>
<tr>
<td><code>SIRL_WARN</code> </td><td align="center"><code>SIRS_FG_YELLOW</code> </td><td><div class="image">
<img src="http://gbtw.us/pub/img/warning.png" alt="warning"/>
</div>
 </td></tr>
<tr>
<td><code>SIRL_ERROR</code> </td><td align="center"><code>SIRS_FG_RED</code> </td><td><div class="image">
<img src="http://gbtw.us/pub/img/error.png" alt="error"/>
</div>
 </td></tr>
<tr>
<td><code>SIRL_CRIT</code> </td><td align="center"><code>SIRS_BRIGHT | SIRS_FG_RED</code> </td><td><div class="image">
<img src="http://gbtw.us/pub/img/critical.png" alt="critical"/>
</div>
 </td></tr>
<tr>
<td><code>SIRL_ALERT</code> </td><td align="center"><code>SIRS_BRIGHT | SIRS_FG_BLACK | SIRS_BG_LYELLOW</code> </td><td><div class="image">
<img src="http://gbtw.us/pub/img/alert.png" alt="alert"/>
</div>
 </td></tr>
<tr>
<td><code>SIRL_EMERG</code> </td><td align="center"><code>SIRS_BRIGHT | SIRS_FG_LYELLOW | SIRS_BG_RED</code> </td><td><div class="image">
<img src="http://gbtw.us/pub/img/emergency.png" alt="emergency"/>
</div>
 </td></tr>
</table>
<h3><a class="anchor" id="preproc"></a>
Preprocessor</h3>
<ul>
<li>For my own development purposes, I included a preprocesor define that causes libsir to log certain events to <code>stderr</code> that may be useful in diagnosing problems if/when they arise: <code>-DSIR_SELFLOG</code>.</li>
<li>You should also be aware that <code>assert</code> is used in libsir. If you build <em>without</em> <code>-DNDEBUG</code>, and an <code>assert</code> triggers, your program will halt (<code>assert</code> calls <code>abort</code> if the expression is <code>false</code>.</li>
</ul>
<h2><a class="anchor" id="why"></a>
Why</h2>
<hr/>
<p>libsir was originally written in 2003, and I rediscovered it recently. I looked at it and realized that it was woefully inadequate and decided to just compeltely rewrite it. This was in the context of R&amp;D for a new embedded application for Sparkage Inc. We specialize in cloud-based mobile-first <a href="https://getsparkage.com">loyalty and rewards software</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Sep 13 2018 11:51:28 for libsir by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
